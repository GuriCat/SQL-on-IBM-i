# 3 SQLの呼出し方法

<p>　</p>

次にDb2 for i のSQLの呼び出し方について考察します。この表は呼出し手法を一覧にしたものです。

?> 表の内容は作成者の理解・見解に基づいており、厳密・正確ではないケースがあります。

![3_SQLの呼出し方法.jpg](/files/3_SQLの呼出し方法.jpg)

<p>　</p>

様々な方法が提供されており、実行環境や用途、言語にあわせて柔軟に選択できます。IBM i のアプリケーション開発や運用を行っている方は、このうちのいくつかは利用したことがあるかもしれません。

それぞれ簡単に解説します。

* ライセンス・プログラム57xx-ST1が提供する「対話型SQL」と「組み込みSQL」は歴史が古く、業務で利用しているケースも多いでしょう。
* RUNSQL/RUNSQLSTMコマンドはCLから簡単にSQLを実行できます。RUNSQLSTMはソースにあらかじめSQLやCLコマンドを記述し、これを順次実行します。RUNSQLは単一のSQLコマンドを実行します。
* QMQRYは利用例が少ないと思われますが、既存のQuery/400の定義をSQLベースのQMQRYに変換する機能があります。QMQRYは実行時にパラメーターが渡せる、SQLで直接照会を記述できる、などの利点もあるので、移行するメリットがあるかもしれません。
* CLIは「Call Level Interface」の略で、The Open Groupが開発したSQLベースのDBMSのための標準APIです。IBM i でもILE言語からDB2 for i CLI関数を利用してSQLが実行できます。

?> SQL命令をコマンド入力するインターフェース、または、ツールをCLI(Command Line Interface)と呼ぶこともあります。

* LUWと同様、Qshellからdb2コマンドで直接SQLを実行する事ができます。シェルスクリプトと組み合わせた処理を行う場合は便利でしょう。
* ACSにはSQLスクリプト機能が組み込まれています。Windows10への移行でACSが普及するに伴い、SQLスクリプトを利用するケースが以前より増えているかもしれません。SQLスクリプトはパフォーマンスモニターやVisual Explainも統合されており、非常に使い勝手がよいです。
* Access for Web/MobileはWebブラウザからガイド付きでSQLを実行し、保管や再利用、タスク化が可能です。SQLの結果をCSVやExcelなどの形式でダウンロードする事もできます。
* ODBC/JDBCを使えば、それぞれのAPIに準拠したツールを利用したり、プログラムを開発したりできます。Windows用、PASE用のODBCドライバーはACSと同様に配布されています。JDBCドライバーはタイプ4(ピュアjava)であり、Windows、Linux、そしてIBM iなどのJVMが稼働する環境で利用できます。

?> JDBCドライバーの実態は「jt400.jar」というアーカイブであり、インターネット、IBM i のIFSディレクトリー「/QIBM/ProdData/HTTP/Public/jt400/lib」などからコピーして利用できます。

---

以降の4～6章で下記SQL利用方法のハンズオンを行います。

![3_SQL利用方法.jpg](/files/3_SQL利用方法.jpg)

